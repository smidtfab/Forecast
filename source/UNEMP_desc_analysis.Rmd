---
title: "UNEMP"
author: "Henry Min√∂r"
date: "19 2 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
rm(list=ls())

library(tseries)
library(moments)
library(dplyr)
library(sandwich) ## used to compute NW SE's
library(lmtest)
library(tidyverse)

getCurrentFileLocation <-  function() {
  this_file <- commandArgs() %>% 
    tibble::enframe(name = NULL) %>%
    tidyr::separate(col=value, into=c("key", "value"), sep="=", fill='right') %>%
    dplyr::filter(key == "--file") %>%
    dplyr::pull(value)
  if (length(this_file)==0) {
    this_file <- rstudioapi::getSourceEditorContext()$path
  }
  return(dirname(this_file))
}

file_dir <- getCurrentFileLocation()
setwd(file_dir)

# get utilities
source("../lib/utilities.R")
```

Read the data
```{r}
us <- read.csv("../data/uncertainty_full.csv")
attach(us)
datesus <- as.Date(DATE)
```

Moments:
```{r}
stats.UNRATE <- as.matrix( c( mean(UNRATE) , sd(UNRATE) , skewness(UNRATE) , kurtosis(UNRATE) ) ) 
dimnames(stats.UNRATE)[[1]] <- list('mean','std. dev.','skew','kurt')
```


Plot the data:
```{r}
png("../images/monthly/UNEMP/UNRATE.png")
myplot(datesus[1:length(datesus)], UNRATE, col="tomato", main='')
abline(h=mean(UNRATE) , lwd=2)
dev.off()

### QQ Norms
png("../images/monthly/UNEMP/QQ_UNRATE.png")
qqnorm(UNRATE, col="tomato", main='')
qqline(UNRATE,lwd=2,lty=3)
dev.off()

### histograms
png("../images/monthly/UNEMP/histograms_UNRATE.png")
hist(UNRATE,50,freq=FALSE,col='tomato',border='darkred', main='', xlab='')
dev.off()

### Kernels
png("../images/monthly/UNEMP/kernels_UNRATE.png")
plot( density(UNRATE) ,yaxs='i', xlab='', main='' )
polygon( density(UNRATE),col="tomato" , border='darkred' )
dev.off()

#Autocorrelations:
png(file='../images/monthly/UNEMP/ACF_UNRATE.png') ### all comments afterwards will split be add to the png file (until dev.off)
acf(UNRATE, col='darkorange2', ylim=c(-0.5,1) , lwd=5 , xlim=c(0,25),  main='')
dev.off()

png(file='../images/monthly/UNEMP/PACF_UNRATE.png')
pacf(UNRATE, col='darkorange2', ylim=c(-0.5,1) , lwd=5 , xlim=c(0,25), main='' )
dev.off()

```


Tests:
```{r}
#T-Test for mean zero
t.test(UNRATE, mu=mean(UNRATE))
ttest.UNRATE <- t.test(UNRATE, mu=mean(UNRATE))
T.UNRATE <- as.matrix( c(ttest.UNRATE$statistic, ttest.UNRATE$p.value ) ) 
dimnames(T.UNRATE)[[1]] <- list('Statistic', 'P-Value')
round(T.UNRATE, 3)

# Test for stationarity
adf.test(us$UNRATE)
adf.UNRATE <- adf.test((UNRATE))
ADF.UNRATE <- as.matrix( c(adf.UNRATE$statistic, adf.UNRATE$p.value ) ) 
dimnames(ADF.UNRATE)[[1]] <- list('Statistic', 'P-Value')
round(ADF.UNRATE, 3)

#Jarque-Bera test for normality:
jarque.test(UNRATE)
jb.UNRATE <- jarque.test((UNRATE))
JB.UNRATE <- as.matrix(c(jb.UNRATE$statistic, jb.UNRATE$p.value))
dimnames(JB.UNRATE)[[1]] <- list('Statistic', 'P-Value')
JB.UNRATE

#Ljung-Box Tests autocorrelation:
Box.test(UNRATE , type = c("Ljung-Box"))
box.UNRATE <- Box.test(UNRATE , type = c("Ljung-Box"))
BOX.UNRATE <- as.matrix( c(box.UNRATE$statistic, box.UNRATE$p.value ) ) 
dimnames(BOX.UNRATE)[[1]] <- list('Statistic', 'P-Value')
round(BOX.UNRATE, 3)
```


